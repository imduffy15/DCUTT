<!DOCTYPE html>
<html xmlns:ng="http://angularjs.org" lang="en">
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>DCU Timetables</title>
      <meta name="description" content="Mobile web app for accessing DCU timetables">
      <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
        
      <meta itemprop="name" content="DCU Timetables">
      <meta itemprop="description" content="DCU Timetables">
      <meta itemprop="image" content="http://dcutt.com/img/icons/icon-144.png">
    
      <meta property="og:title" content="DCU Timetables">
      <meta property="og:description" content="DCU Timetables">
      <meta property="og:image" content="http://dcutt.com/img/icons/icon-144.png">

      <link rel="apple-touch-icon-precomposed" sizes="144x144" href="img/icons/icon-144.png">
      <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/icons/icon-114.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/icons/icon-72.png">
      <link rel="apple-touch-icon-precomposed" href="img/icons/icon-57.png">
      <link rel="shortcut icon" href="img/icons/icon-57.png">

      <meta name="apple-mobile-web-app-capable" content="yes">
      
      <link rel="stylesheet" href="styles/main.css">
			<script>
		  var _gaq = _gaq || [];
		  	_gaq.push(['_setAccount', 'UA-36286955-1']);
		  	_gaq.push(['_trackPageview']);

		  	(function() {
		    	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
				})();

				if (window.applicationCache){
					// "Naturally" reload when an update is available
					var reload = false;
					window.applicationCache.addEventListener('updateready', function(){
						if (window.applicationCache.status == window.applicationCache.UPDATEREADY){
							window.applicationCache.swapCache();
							reload = true;
						}
					}, false);

					setInterval(function(){
						try { // There's nothing to update for first-time load, browser freaks out :/
							window.applicationCache.update();
						} catch (e){}
					}, 1000*60*60); // Every hour

					var checkReload = function(){
						if (reload) location.reload();
					};
					window.addEventListener('pageshow', checkReload, false);
					window.addEventListener('focus', checkReload, false);

					// Use GA to track the update rate of this manifest appcache thing
					// and see how fast users are updated to the latest cache/version
					if (typeof _gaq != 'undefined') window.addEventListener('load', function(){
						setTimeout(function(){
							var r = new XMLHttpRequest();
							r.open('GET', 'manifest.appcache', true);
							r.onload = function(){
								var text = this.responseText;
								if (!text) return;
								var version = (text.match(/#\s\d[^\n\r]+/) || [])[0];
								if (version) _gaq.push(['_trackEvent', 'Appcache', 'Version', version.replace(/^#\s/, '')]);
							};
							r.send();
						}, 1000);
					}, false);
				} else {
					setTimeout(function(){
						_gaq.push(['_trackEvent', 'Appcache', 'Version', 'n/a']);
					}, 1000);
				}
			</script>
  </head>
  <body id="ng-app" ng-app="dcuTimetablesApp">      
      <div ng-view>
      </div>
      
      <script src="scripts/vendor/angular.min.js"></script>
      <script src="scripts/vendor/zepto.min.js"></script>
      <script src="scripts/vendor/moment.min.js"></script>
      <script src="scripts/vendor/iscroll.min.js"></script>
      <script src="scripts/vendor/fastclick.min.js"></script>
      
      <!-- build:js scripts/scripts.js -->
      <script src="scripts/app.js"></script>
      <script src="scripts/controllers/main.js"></script>
      <script src="scripts/controllers/timetable.js"></script>
      <script src="scripts/controllers/settings.js"></script>
      <script src="scripts/directives/timetable.js"></script>
			<script src="scripts/controllers/error.js"></script>
      <!-- endbuild -->
  </body>
</html>
