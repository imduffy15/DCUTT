function FastClick(b){var c,a=this;this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.layer=b;if(!b||!b.nodeType){throw new TypeError("Layer must be a document node")}this.onClick=function(){FastClick.prototype.onClick.apply(a,arguments)};this.onTouchStart=function(){FastClick.prototype.onTouchStart.apply(a,arguments)};this.onTouchMove=function(){FastClick.prototype.onTouchMove.apply(a,arguments)};this.onTouchEnd=function(){FastClick.prototype.onTouchEnd.apply(a,arguments)};this.onTouchCancel=function(){FastClick.prototype.onTouchCancel.apply(a,arguments)};if(typeof window.ontouchstart==="undefined"){return}b.addEventListener("click",this.onClick,true);b.addEventListener("touchstart",this.onTouchStart,false);b.addEventListener("touchmove",this.onTouchMove,false);b.addEventListener("touchend",this.onTouchEnd,false);b.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){b.removeEventListener=function(e,g,d){var f=Node.prototype.removeEventListener;if(e==="click"){f.call(b,e,g.hijacked||g,d)}else{f.call(b,e,g,d)}};b.addEventListener=function(f,g,e){var d=Node.prototype.addEventListener;if(f==="click"){d.call(b,f,g.hijacked||(g.hijacked=function(h){if(!h.propagationStopped){g(h)}}),e)}else{d.call(b,f,g,e)}}}if(typeof b.onclick==="function"){c=b.onclick;b.addEventListener("click",function(d){c(d)},false);b.onclick=null}}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0;FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&(/OS ([6-9]|\d{2})_\d/).test(navigator.userAgent);FastClick.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"input":return a.disabled;case"label":case"video":return true;default:return(/\bneedsclick\b/).test(a.className)}};FastClick.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":case"select":return true;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return !a.disabled;default:return(/\bneedsfocus\b/).test(a.className)}};FastClick.prototype.sendClick=function(b,c){var a,d;if(document.activeElement&&document.activeElement!==b){document.activeElement.blur()}d=c.changedTouches[0];a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,true,window,1,d.screenX,d.screenY,d.clientX,d.clientY,false,false,false,false,0,null);a.forwardedTouchEvent=true;b.dispatchEvent(a)};FastClick.prototype.focus=function(a){var b;if(this.deviceIsIOS&&a.setSelectionRange){b=a.value.length;a.setSelectionRange(b,b)}else{a.focus()}};FastClick.prototype.updateScrollParent=function(b){var c,a;c=b.fastClickScrollParent;if(!c||!c.contains(b)){a=b;do{if(a.scrollHeight>a.offsetHeight){c=a;b.fastClickScrollParent=a;break}a=a.parentElement}while(a)}if(c){c.fastClickLastScrollTop=c.scrollTop}};FastClick.prototype.getTargetElementFromEventTarget=function(a){if(a.nodeType===Node.TEXT_NODE){return a.parentNode}return a};FastClick.prototype.onTouchStart=function(b){var a,c;a=this.getTargetElementFromEventTarget(b.target);c=b.targetTouches[0];if(this.deviceIsIOS){if(window.getSelection().rangeCount){return true}if(!this.deviceIsIOS4){if(c.identifier===this.lastTouchIdentifier){b.preventDefault();return false}this.lastTouchIdentifier=c.identifier;this.updateScrollParent(a)}}this.trackingClick=true;this.trackingClickStart=b.timeStamp;this.targetElement=a;this.touchStartX=c.pageX;this.touchStartY=c.pageY;if((b.timeStamp-this.lastClickTime)<200){b.preventDefault()}return true};FastClick.prototype.touchHasMoved=function(a){var b=a.targetTouches[0];if(Math.abs(b.pageX-this.touchStartX)>10||Math.abs(b.pageY-this.touchStartY)>10){return true}return false};FastClick.prototype.onTouchMove=function(a){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a)){this.trackingClick=false;this.targetElement=null}return true};FastClick.prototype.findControl=function(a){if(a.control!==undefined){return a.control}if(a.htmlFor){return document.getElementById(a.htmlFor)}return a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};FastClick.prototype.onTouchEnd=function(c){var e,d,b,g,f,a=this.targetElement;if(!this.trackingClick){return true}if((c.timeStamp-this.lastClickTime)<200){this.cancelNextClick=true;return true}this.lastClickTime=c.timeStamp;d=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(this.deviceIsIOSWithBadTarget){f=c.changedTouches[0];a=c.target;a=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)}b=a.tagName.toLowerCase();if(b==="label"){e=this.findControl(a);
if(e){this.focus(a);if(this.deviceIsAndroid){return false}a=e}}else{if(this.needsFocus(a)){if((c.timeStamp-d)>100||(this.deviceIsIOS&&window.top!==window&&b==="input")){this.targetElement=null;return false}this.focus(a);if(!this.deviceIsIOS4||b!=="select"){this.targetElement=null;c.preventDefault()}return false}}if(this.deviceIsIOS&&!this.deviceIsIOS4){g=a.fastClickScrollParent;if(g&&g.fastClickLastScrollTop!==g.scrollTop){return true}}if(!this.needsClick(a)){c.preventDefault();this.sendClick(a,c)}return false};FastClick.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};FastClick.prototype.onClick=function(b){var a;if(!this.targetElement){return true}if(b.forwardedTouchEvent){return true}a=this.targetElement;this.targetElement=null;if(this.trackingClick){this.trackingClick=false;return true}if(!b.cancelable){return true}if(b.target.type==="submit"&&b.detail===0){return true}if(!this.needsClick(a)||this.cancelNextClick){this.cancelNextClick=false;if(b.stopImmediatePropagation){b.stopImmediatePropagation()}else{b.propagationStopped=true}b.stopPropagation();b.preventDefault();return false}return true};FastClick.prototype.destroy=function(){var a=this.layer;a.removeEventListener("click",this.onClick,true);a.removeEventListener("touchstart",this.onTouchStart,false);a.removeEventListener("touchmove",this.onTouchMove,false);a.removeEventListener("touchend",this.onTouchEnd,false);a.removeEventListener("touchcancel",this.onTouchCancel,false)};if(typeof define!=="undefined"&&define.amd){define(function(){return FastClick})}if(typeof module!=="undefined"&&module.exports){module.exports=function(a){return new FastClick(a)};module.exports.FastClick=FastClick};